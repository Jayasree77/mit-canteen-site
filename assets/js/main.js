// ------------------ Menu.html Menu Cards ------------------------
var menu = {
    "items": [
        {
            "sys": { "id": "1" },
            "fields": {
                "title": "Double Cheese Potato Burger",
                "category": "Burger",
                "price": "45",
                "caleories": "220 - 280 Kcal",
                "image": { "fields": {"file": { "url": "assets/images/sandwich1.jpg" } } }
            }
        },
        {
            "sys": { "id": "2" },
            "fields": {
                "title": "Cheese Sandwitch",
                "category": "Sandwitch",
                "price": "45",
                "caleories": "220 - 280 Kcal",
                "image": { "fields": {"file": { "url": "assets/images/sandwich1.jpg" } } }
            }
        },
        {
            "sys": { "id": "3" },
            "fields": {
                "title": "Veg Club Sandwitch",
                "category": "Sandwitch",
                "price": "60",
                "caleories": "220 - 280 Kcal",
                "image": { "fields": {"file": { "url": "assets/images/sandwich1.jpg" } } }
            }
        },
        {
            "sys": { "id": "4" },
            "fields": {
                "title": "Cheese Masala Sandwitch",
                "category": "Sandwitch",
                "price": "45",
                "caleories": "220 - 280 Kcal",
                "image": { "fields": {"file": { "url": "assets/images/sandwich1.jpg" } } }
            }
        },
        {
            "sys": { "id": "5" },
            "fields": {
                "title": "Veg Schezuan Sandwitch",
                "category": "Sandwitch",
                "price": "45",
                "caleories": "220 - 280 Kcal",
                "image": { "fields": {"file": { "url": "assets/images/sandwich1.jpg" } } }
            }
        },
        {
            "sys": { "id": "6" },
            "fields": {
                "title": "Masala Maggie",
                "category": "Maggie",
                "price": "25",
                "caleories": "220 - 280 Kcal",
                "image": { "fields": {"file": { "url": "assets/images/sandwich1.jpg" } } }
            }
        },
        {
            "sys": { "id": "7" },
            "fields": {
                "title": "Schezuan Maggie",
                "category": "Maggie",
                "price": "30",
                "caleories": "220 - 280 Kcal",
                "image": { "fields": {"file": { "url": "assets/images/sandwich1.jpg" } } }
            }
        },
        {
            "sys": { "id": "8" },
            "fields": {
                "title": "Veg Maggie",
                "category": "Maggie",
                "price": "30",
                "caleories": "220 - 280 Kcal",
                "image": { "fields": {"file": { "url": "assets/images/sandwich1.jpg" } } }
            }
        },
        {
            "sys": { "id": "9" },
            "fields": {
                "title": "Cheese Garlic Maggie",
                "category": "Maggie",
                "price": "40",
                "caleories": "220 - 280 Kcal",
                "image": { "fields": {"file": { "url": "assets/images/sandwich1.jpg" } } }
            }
        },
        {
            "sys": { "id": "10" },
            "fields": {
                "title": "Cheese Veg Maggie",
                "category": "Maggie",
                "price": "45",
                "caleories": "220 - 280 Kcal",
                "image": { "fields": {"file": { "url": "assets/images/sandwich1.jpg" } } }
            }
        },
        {
            "sys": { "id": "11" },
            "fields": {
                "title": "Masala Fries",
                "category": "Fries",
                "price": "35",
                "caleories": "220 - 280 Kcal",
                "image": { "fields": {"file": { "url": "assets/images/sandwich1.jpg" } } }
            }
        },
        {
            "sys": { "id": "12" },
            "fields": {
                "title": "Schezuan Fries",
                "category": "Fries",
                "price": "45",
                "caleories": "220 - 280 Kcal",
                "image": { "fields": {"file": { "url": "assets/images/sandwich1.jpg" } } }
            }
        },
        {
            "sys": { "id": "13" },
            "fields": {
                "title": "Cheese Fries",
                "category": "Fries",
                "price": "40",
                "caleories": "220 - 280 Kcal",
                "image": { "fields": {"file": { "url": "assets/images/sandwich1.jpg" } } }
            }
        },
        {
            "sys": { "id": "14" },
            "fields": {
                "title": "Red Sause Pasta",
                "category": "Pasta",
                "price": "80",
                "caleories": "220 - 280 Kcal",
                "image": { "fields": {"file": { "url": "assets/images/sandwich1.jpg" } } }
            }
        },
        {
            "sys": { "id": "15" },
            "fields": {
                "title": "White Sause Pasta",
                "category": "Pasta",
                "price": "80",
                "caleories": "220 - 280 Kcal",
                "image": { "fields": {"file": { "url": "assets/images/sandwich1.jpg" } } }
            }
        },
        {
            "sys": { "id": "16" },
            "fields": {
                "title": "Milk Shakes",
                "category": "Beverages",
                "price": "35",
                "caleories": "220 - 280 Kcal",
                "image": { "fields": {"file": { "url": "assets/images/sandwich1.jpg" } } }
            }
        },
        {
            "sys": { "id": "17" },
            "fields": {
                "title": "Hot Chocolate",
                "category": "Beverages",
                "price": "35",
                "caleories": "220 - 280 Kcal",
                "image": { "fields": {"file": { "url": "assets/images/sandwich1.jpg" } } }
            }
        },
        {
            "sys": { "id": "18" },
            "fields": {
                "title": "Aerated Drinks",
                "category": "Beverages",
                "price": "10",
                "caleories": "220 - 280 Kcal",
                "image": { "fields": {"file": { "url": "assets/images/sandwich1.jpg" } } }
            }
        },
        {
            "sys": { "id": "19" },
            "fields": {
                "title": "Cold Coffee",
                "category": "Beverages",
                "price": "35",
                "caleories": "220 - 280 Kcal",
                "image": { "fields": {"file": { "url": "assets/images/sandwich1.jpg" } } }
            }
        },
        {
            "sys": { "id": "20" },
            "fields": {
                "title": "Coffee",
                "category": "Beverages",
                "price": "15",
                "caleories": "220 - 280 Kcal",
                "image": { "fields": {"file": { "url": "assets/images/sandwich1.jpg" } } }
            }
        },
        {
            "sys": { "id": "21" },
            "fields": {
                "title": "Tea",
                "category": "Beverages",
                "price": "10",
                "caleories": "220 - 280 Kcal",
                "image": { "fields": {"file": { "url": "assets/images/sandwich1.jpg" } } }
            }
        },
        {
            "sys": { "id": "22" },
            "fields": {
                "title": "Chocate Frappe",
                "category": "Beverages",
                "price": "35",
                "caleories": "220 - 280 Kcal",
                "image": { "fields": {"file": { "url": "assets/images/sandwich1.jpg" } } }
            }
        },
        {
            "sys": { "id": "23" },
            "fields": {
                "title": "Veg Puff",
                "category": "Bakery",
                "price": "35",
                "caleories": "220 - 280 Kcal",
                "image": { "fields": {"file": { "url": "assets/images/sandwich1.jpg" } } }
            }
        },
        {
            "sys": { "id": "24" },
            "fields": {
                "title": "Panner Puff",
                "category": "Bakery",
                "price": "15",
                "caleories": "220 - 280 Kcal",
                "image": { "fields": {"file": { "url": "assets/images/sandwich1.jpg" } } }
            }
        },
        {
            "sys": { "id": "25" },
            "fields": {
                "title": "Khari",
                "category": "Bakery",
                "price": "20",
                "caleories": "220 - 280 Kcal",
                "image": { "fields": {"file": { "url": "assets/images/sandwich1.jpg" } } }
            }
        },
        {
            "sys": { "id": "26" },
            "fields": {
                "title": "Noodle Puff",
                "category": "Bakery",
                "price": "15",
                "caleories": "220 - 280 Kcal",
                "image": { "fields": {"file": { "url": "assets/images/sandwich1.jpg" } } }
            }
        }
    ]
}

const menuSection = document.querySelector('.menu-section');

// Function To Create Menu Cards & Add to HTML
function displayMenuItems(menuItems){
    let displayMenu = menuItems.items.map(function(item){
        return `
        <article class="menu-item">
            <img src="${item.fields.image.fields.file.url}" alt="Product image">
            <div class="item-info">
            <figure>
                <h2>${item.fields.title}</h2>
                <div class="item-category">${item.fields.category}</div>
                <div class="flex">
                    <i class="fas fa-fire"></i>
                    <p>${item.fields.caleories}</p>
                </div>
            </figure>
            <hr style="margin: 10px 0;">
            <div class="menu-cart-functionality">
                <div class="price">$${item.fields.price}</div>
                <div class="cart-btn-container">
                    <button class="bag-btn" data-id=${item.sys.id}>Add to Cart</i></button>
                </div>
            </div>
            </div>
        </article>
        `;
    });

    displayMenu = displayMenu.join('');
    menuSection.innerHTML = displayMenu;
}

// ------------------ Menu.html Menu Cards END ------------------------

// --- Product functioning ---
class Products {
// Add Products To Admin Pannel -
AdminAddProduct() { /* To Admin Database */ }

// Add Products To Admin Pannel -
AdminRemoveProduct() { /* To Admin Database */ }

// Add Update Product To Admin Pannel -
AdminUpdateProduct() { /* To Admin Database */ }

// Get products and display them to customer menu panel -
getProducts() { }

}
  
// --- Cart Functioning ---
var cart = []
const cartItemsContainer = document.querySelector('.cart-items-container');
const cartItems = document.querySelector('.cart-items');
const cartTotal = document.querySelector('.cart-total');

var newCart = []
class UI {

    addItemCartValues(item, menuItems){
        let id = item.dataset.id;
        menuItems.items.map(function(item) {
            if (item.sys.id === id ){
                let amount = 1
                cart.push({ID: id, Amount:1})
                Storage.saveCart(cart)
            }
        })
    }

    showCartItem(){
        let items = Storage.getCart();
        console.log(items);
    
        items.forEach(item=>{
            let id = item.ID;

            if (menu.items[id-1].sys.id === id && id != cart.find(i => i > 1 && i === id)){
                console.log(id);
                const div = document.createElement('article');
                div.classList.add('cart-item')
                div.innerHTML = `
                    <div><img src="assets/images/sandwich2.jpg" alt="Food item image"></div>
                    <div class="cart-info">
                        <h3>${menu.items[id-1].fields.title}</h3>
                        <p>${menu.items[id-1].fields.price}</p>
                        <span class="remove-item">remove</span>
                    </div>
                    <div class="flex-column"> 
                        <i class="fas fa-chevron-up"></i>
                        <p class="item-amount">${item.Amount}</p>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                `
                // cartItemsContainer.appendChild(div);
                newCart.push(div)
            }
        })
        this.showInCart()
    }
    
    showInCart() {
        // newCart.forEach(element => cartItemsContainer.appendChild(element));
        const lastAdded = newCart[newCart.length-1]
        cartItemsContainer.appendChild(lastAdded)
    }

    setUpApp() {
        this.showCartItem();
    }
}

// Local Storage
class Storage {
    static saveProducts(products){
          localStorage.setItem('products', JSON.stringify(products));
    }

    static getProduct(id) {
        // goes into Browser -> Application -> localStorage -> method(getItem(stuff here it is array)) -> 
        let products = JSON.parse(localStorage.getItem('products')); 
        return products.find(product => product.id === id)
    }

    static saveCart(cart){
        localStorage.setItem('cart', JSON.stringify(cart));
    }

    static getCart(){
        return localStorage.getItem('cart')?JSON.parse
        (localStorage.getItem('cart')):[]
    }
}

document.addEventListener('DOMContentLoaded', () =>{
    const ui = new UI();

    displayMenuItems(menu);

    const bagBtn = document.querySelectorAll('.bag-btn');
    // Cart Buttons -
    bagBtn.forEach(addCartBtn => {
        addCartBtn.addEventListener('click', ()=>{
            ui.addItemCartValues(addCartBtn, menu);
            ui.setUpApp()
        });
    });
    
});

